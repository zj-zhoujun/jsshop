{"version":3,"sources":["webpack:///src/pages/other/History.vue","webpack:///./src/pages/other/History.vue?c8c8","webpack:///./src/pages/other/History.vue"],"names":["History","goodsBrowsing","goodsId","_this","this","page","pageSize","res","list","_list","_this2","ctime","clientX","parentElement","restSlide","_this3","index","goods_id","other_History","render","_vm","_h","$createElement","_c","_self","staticClass","ref","attrs","callback","loadMore","distance","slot","_l","item","key","data-type","staticStyle","padding","on","!touchstart","$event","touchStart","!touchend","touchEnd","click","showDetail","directives","name","rawName","value","goods","expression","_v","_s","goods_name","price","src","__webpack_require__","data-index","deleteItem","_e","staticRenderFns","Component","normalizeComponent","ssrContext","__webpack_exports__"],"mappings":"oJA8BAA,+BAIA,WACA,qCAKAC,wGAIAC,+BAEA,IAAAC,EAAAC,wCAEAC,gBACAC,UAFA,SAAAC,6BAIAC,2BACAC,0DAGA,yDAKA,IAAAC,EAAAN,0CAEAC,gBACAC,UAFA,SAAAC,6BAIAC,uCACAC,yDAGA,mEAIA,kHAKAE,cAEAH,qEAaAI,oDAKAC,4CAEAD,8DAGAE,2BACA,0DAIAA,2BACA,eAEA,YACA,6DAIA,mEAGA,SAGA,4DAIA,mDAGA,0BAIA,IAAAC,EAAAX,+BAEAY,yDAEAC,UADA,SAAAV,yDAIA,cAEAO,4BAEA,gDAEA,eC/IAI,GADiBC,OAFjB,WAA0B,IAAAC,EAAAhB,KAAaiB,EAAAD,EAAAE,eAA0BC,EAAAH,EAAAI,MAAAD,IAAAF,EAAwB,OAAAE,EAAA,OAAiBE,YAAA,YAAsBF,EAAA,qBAA0BG,IAAA,qBAAAC,OAAgCC,SAAAR,EAAAS,SAAAC,SAAA,KAAsCP,EAAA,MAAWI,OAAOI,KAAA,QAAcA,KAAA,QAAaX,EAAAY,GAAAZ,EAAA,cAAAa,EAAAjB,GAAwC,OAAAiB,EAAA,MAAAV,EAAA,MAA6BW,IAAAlB,EAAAS,YAAA,YAAAE,OAAyCQ,YAAA,OAAiBZ,EAAA,OAAYE,YAAA,WAAAW,aAAoCC,QAAA,UAAmBC,IAAKC,cAAA,SAAAC,GAA+B,OAAApB,EAAAqB,WAAAD,IAA8BE,YAAA,SAAAF,GAA8B,OAAApB,EAAAuB,SAAAH,IAA4BI,MAAA,SAAAJ,GAA0BpB,EAAAyB,WAAAZ,EAAAhB,cAAgCM,EAAA,OAAYuB,aAAaC,KAAA,OAAAC,QAAA,SAAAC,MAAAhB,EAAAiB,MAAA,UAAAC,WAAA,yBAA4F1B,YAAA,WAAAE,OAAgCI,KAAA,OAAaA,KAAA,QAAYX,EAAAgC,GAAA,KAAA7B,EAAA,OAAwBE,YAAA,cAAwBF,EAAA,MAAWE,YAAA,YAAAE,OAA+BI,KAAA,SAAeA,KAAA,UAAcX,EAAAgC,GAAAhC,EAAAiC,GAAApB,EAAAqB,eAAAlC,EAAAgC,GAAA,KAAA7B,EAAA,OAA0DE,YAAA,eAAyBF,EAAA,OAAAA,EAAA,QAAuBE,YAAA,oBAA8BF,EAAA,MAAAH,EAAAgC,GAAA,OAAAhC,EAAAgC,GAAAhC,EAAAiC,GAAApB,EAAAiB,MAAAK,cAAAnC,EAAAgC,GAAA,KAAA7B,EAAA,OAAsFI,OAAOI,KAAA,SAAeA,KAAA,UAAcR,EAAA,OAAAA,EAAA,QAAuBE,YAAA,SAAmBL,EAAAgC,GAAAhC,EAAAiC,GAAApB,EAAAtB,cAAAS,EAAAgC,GAAA,KAAA7B,EAAA,OAAyDE,YAAA,YAAAE,OAA+BI,KAAA,QAAAyB,IAAAC,EAAA,SAAgE1B,KAAA,cAAcX,EAAAgC,GAAA,KAAA7B,EAAA,OAA4BE,YAAA,SAAAE,OAA4B+B,aAAA1C,GAAmBsB,IAAKM,MAAAxB,EAAAuC,cAAwBvC,EAAAgC,GAAA,UAAAhC,EAAAwC,WAA4B,IAE/+CC,oBCCjB,IAcAC,EAdAL,EAAA,OAcAM,CACA/D,EACAkB,GATA,EAVA,SAAA8C,GACAP,EAAA,SAaA,KAEA,MAUAQ,EAAA,QAAAH,EAAA","file":"static/js/33.ffa9f21cf6bfde6d8307.js","sourcesContent":["<template>\n    <div class=\"history\">\n        <yd-infinitescroll :callback=\"loadMore\" :distance=\"2\" ref=\"infinitescrollDemo\">\n            <ul slot=\"list\">\n                <li class=\"list-item\" data-type=\"0\" v-for=\"(item, index) in list\" :key=\"index\" v-if=\"item.goods\">\n                    <div class=\"list-box\" style=\"padding: .15rem;\" @touchstart.capture=\"touchStart\" @touchend.capture=\"touchEnd\" @click=\"showDetail(item.goods_id)\">\n                        <img class=\"goodsimg\" slot=\"img\" v-lazy=\"item.goods.image_url\">\n                        <div class=\"list-body\">\n                            <h3 class=\"goodsname\" slot=\"title\">{{ item.goods_name }}</h3>\n                            <div class=\"btn-numbox\">\n                                <div>\n                                    <span class=\"demo-list-price\"><em>¥</em>{{ item.goods.price }}</span>\n                                </div>\n                            </div>\n                            <div slot=\"other\">\n                                <div>\n                                    <span class=\"time\">{{ item.ctime }}</span>\n                                </div>\n                            </div>\n                            <img class=\"right-img\" slot=\"other\" src=\"../../../static/image/right.png\"/>\n                        </div>\n                    </div>\n                    <div class=\"delete\" @click=\"deleteItem\" :data-index=\"index\">删除</div>\n                </li>\n            </ul>\n        </yd-infinitescroll>\n    </div>\n</template>\n\n<script>\nexport default {\n    data () {\n        return {\n            page: 1,\n            pageSize: 10,\n            list: [] // 商品浏览足迹\n        }\n    },\n    created () {\n        this.goodsBrowsing()\n    },\n    methods: {\n        showDetail (goodsId) {\n            this.$router.push({path: '/goodsdetail', query: {goods_id: goodsId}})\n        },\n        goodsBrowsing () {\n            this.$api.goodsBrowsing({\n                page: this.page,\n                limit: this.pageSize\n            }, res => {\n                const _list = this.dateFormat(res.data.list)\n                this.list = [..._list]\n                if (_list.length < this.pageSize) {\n                    /* 所有数据加载完毕 */\n                    this.$refs.infinitescrollDemo.$emit('ydui.infinitescroll.loadedDone')\n                }\n            })\n        },\n        // 加载更多\n        loadMore () {\n            this.$api.goodsBrowsing({\n                page: ++this.page,\n                limit: this.pageSize\n            }, res => {\n                const _list = this.dateFormat(res.data.list)\n                this.list = [...this.list, ..._list]\n                if (_list.length < this.pageSize) {\n                    /* 所有数据加载完毕 */\n                    this.$refs.infinitescrollDemo.$emit('ydui.infinitescroll.loadedDone')\n                    return\n                }\n                /* 单次请求数据完毕 */\n                this.$refs.infinitescrollDemo.$emit('ydui.infinitescroll.finishLoad')\n            })\n        },\n        dateFormat (list) {\n            for (let k in list) {\n                list[k].ctime = this.GLOBAL.timeToDate(list[k].ctime)\n            }\n            return list\n        },\n        // 跳转\n        skip () {\n        // if (this.checkSlide()) {\n        //    this.restSlide()\n        // } else {\n        //    alert('You click the slide!')\n        // }\n        },\n        // 滑动开始\n        touchStart (e) {\n            // 记录初始位置\n            this.startX = e.touches[0].clientX\n        },\n        // 滑动结束\n        touchEnd (e) {\n            // 当前滑动的父级元素\n            let parentElement = e.currentTarget.parentElement\n            // 记录结束位置\n            this.endX = e.changedTouches[0].clientX\n            // 左滑\n            if (parentElement.dataset.type === '0' && this.startX - this.endX > 30) {\n                this.restSlide()\n                parentElement.dataset.type = 1\n            }\n            // 右滑\n            if (parentElement.dataset.type === '1' && this.startX - this.endX < -30) {\n                this.restSlide()\n                parentElement.dataset.type = 0\n            }\n            this.startX = 0\n            this.endX = 0\n        },\n        // 判断当前是否有滑块处于滑动状态\n        checkSlide () {\n            let listItems = document.querySelectorAll('.list-item')\n            for (let i = 0; i < listItems.length; i++) {\n                if (listItems[i].dataset.type === '1') {\n                    return true\n                }\n            }\n            return false\n        },\n        // 复位滑动状态\n        restSlide () {\n            let listItems = document.querySelectorAll('.list-item')\n            // 复位\n            for (let i = 0; i < listItems.length; i++) {\n                listItems[i].dataset.type = 0\n            }\n        },\n        // 删除\n        deleteItem (e) {\n            // 当前索引\n            let index = e.currentTarget.dataset.index\n            this.$api.delGoodsBrowsing({\n                goods_ids: this.list[index].goods_id\n            }, res => {\n                if (res.status) {\n                    this.$dialog.toast({mes: res.msg, timeout: 1000, icon: 'success'})\n                    // 复位\n                    this.restSlide()\n                    // 删除\n                    this.list.splice(index, 1)\n                } else {\n                    this.$dialog.toast({mes: res.msg, timeout: 1000, icon: 'error'})\n                }\n            })\n        }\n    }\n}\n</script>\n\n<style>\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/pages/other/History.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"history\"},[_c('yd-infinitescroll',{ref:\"infinitescrollDemo\",attrs:{\"callback\":_vm.loadMore,\"distance\":2}},[_c('ul',{attrs:{\"slot\":\"list\"},slot:\"list\"},_vm._l((_vm.list),function(item,index){return (item.goods)?_c('li',{key:index,staticClass:\"list-item\",attrs:{\"data-type\":\"0\"}},[_c('div',{staticClass:\"list-box\",staticStyle:{\"padding\":\".15rem\"},on:{\"!touchstart\":function($event){return _vm.touchStart($event)},\"!touchend\":function($event){return _vm.touchEnd($event)},\"click\":function($event){_vm.showDetail(item.goods_id)}}},[_c('img',{directives:[{name:\"lazy\",rawName:\"v-lazy\",value:(item.goods.image_url),expression:\"item.goods.image_url\"}],staticClass:\"goodsimg\",attrs:{\"slot\":\"img\"},slot:\"img\"}),_vm._v(\" \"),_c('div',{staticClass:\"list-body\"},[_c('h3',{staticClass:\"goodsname\",attrs:{\"slot\":\"title\"},slot:\"title\"},[_vm._v(_vm._s(item.goods_name))]),_vm._v(\" \"),_c('div',{staticClass:\"btn-numbox\"},[_c('div',[_c('span',{staticClass:\"demo-list-price\"},[_c('em',[_vm._v(\"¥\")]),_vm._v(_vm._s(item.goods.price))])])]),_vm._v(\" \"),_c('div',{attrs:{\"slot\":\"other\"},slot:\"other\"},[_c('div',[_c('span',{staticClass:\"time\"},[_vm._v(_vm._s(item.ctime))])])]),_vm._v(\" \"),_c('img',{staticClass:\"right-img\",attrs:{\"slot\":\"other\",\"src\":require(\"../../../static/image/right.png\")},slot:\"other\"})])]),_vm._v(\" \"),_c('div',{staticClass:\"delete\",attrs:{\"data-index\":index},on:{\"click\":_vm.deleteItem}},[_vm._v(\"删除\")])]):_vm._e()}))])],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-4fc7cf92\",\"hasScoped\":false,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/pages/other/History.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true,\\\"publicPath\\\":\\\"../../\\\"}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-4fc7cf92\\\",\\\"scoped\\\":false,\\\"hasInlineConfig\\\":false}!../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./History.vue\")\n}\nvar normalizeComponent = require(\"!../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./History.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./History.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-4fc7cf92\\\",\\\"hasScoped\\\":false,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../node_modules/vue-loader/lib/selector?type=template&index=0!./History.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/pages/other/History.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}