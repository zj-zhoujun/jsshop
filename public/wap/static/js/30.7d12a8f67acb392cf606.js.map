{"version":3,"sources":["webpack:///src/pages/goods/GoodsList.vue","webpack:///./src/pages/goods/GoodsList.vue?873b","webpack:///./src/pages/goods/GoodsList.vue"],"names":["GoodsList","title","checked","top","bottom","condition","_this","this","goodsList","_this2","index","str","filter","_this3","list","_list","page","_this4","catId","hot","keywords","brand","pageSize","where","data","next","goods_GoodsList","render","_vm","_h","$createElement","_c","_self","staticClass","_l","item","key","class","active","on","click","$event","clickFilter","_v","_s","attrs","src","icons","topChecked","_e","bottomChecked","ref","callback","loadMore","distance","scroll-top","slot","theme","type","href","path","query","goods_id","id","directives","name","rawName","value","expression","price","staticRenderFns","Component","__webpack_require__","normalizeComponent","ssrContext","__webpack_exports__"],"mappings":"2KA+BAA,+BAIA,sBAEAC,MAAA,KAAAC,SAAA,EAAAC,KAAA,EAAAC,QAAA,EAAAC,UACA,KAAAJ,MAAA,KAAAC,SAAA,EAAAC,KAAA,EAAAC,QAAA,EAAAC,UACA,cAAAJ,MAAA,KAAAC,SAAA,EAAAC,KAAA,EAAAC,QAAA,EAAAC,UAEA,qBAEA,wCACA,mCACA,8CAEA,6RAUA,IAAAC,EAAAC,yCACA,8CAEA,uFAIA,+BACA,sCACA,eAEA,SACA,YACA,iCAKA,OAEAC,8CAIA,IAAAC,EAAAF,qEAGAJ,wCACAC,gEAKAM,aACA,eAIA,YAEA,eAGA,SACA,YACA,WAKA,wDACA,6CACAC,uCACAC,yBAEAJ,kCAGA,IAAAK,EAAAN,oEAEAO,0BACAC,0DAGA,oCAEAC,8BAIA,IAAAC,EAAAV,oEAEAO,sCACAC,0DAGA,mEAGA,oCACAC,mEAOAE,4BAEAC,uCAEAC,wCAEAC,yBAGAL,gBACAM,mBAEAC,sCACAX,QACAY,wFAMA,UAEAC,MCnKAC,GADiBC,OAFjB,WAA0B,IAAAC,EAAArB,KAAasB,EAAAD,EAAAE,eAA0BC,EAAAH,EAAAI,MAAAD,IAAAF,EAAwB,OAAAE,EAAA,OAAiBE,YAAA,cAAwBL,EAAAd,KAAA,OAAAiB,EAAA,OAA8BE,YAAA,YAAsBF,EAAA,KAAAH,EAAAM,GAAAN,EAAA,eAAAO,EAAAzB,GAAkD,OAAAqB,EAAA,MAAgBK,IAAA1B,IAAUqB,EAAA,QAAaM,OAAOC,OAAAH,EAAAjC,SAAqBqC,IAAKC,MAAA,SAAAC,GAAyBb,EAAAc,YAAAhC,OAAyBkB,EAAAe,GAAAf,EAAAgB,GAAAT,EAAAlC,UAAA2B,EAAAe,GAAA,KAAAZ,EAAA,OAAqDE,YAAA,aAAuB,EAAAF,EAAA,OAAoBE,YAAA,MAAAY,OAAyBC,IAAAX,EAAAhC,IAAAyB,EAAAmB,MAAAC,WAAApB,EAAAmB,MAAA5C,OAAuDyB,EAAAqB,KAAArB,EAAAe,GAAA,KAAAZ,EAAA,OAAiCE,YAAA,SAAAY,OAA4BC,IAAAX,EAAA/B,OAAAwB,EAAAmB,MAAAG,cAAAtB,EAAAmB,MAAA3C,mBAAsEwB,EAAAqB,KAAArB,EAAAe,GAAA,KAAAZ,EAAA,qBAAkDoB,IAAA,qBAAAlB,YAAA,gBAAAY,OAA4DO,SAAAxB,EAAAyB,SAAAC,SAAA,EAAAC,cAAA,KAAyDxB,EAAA,WAAgBc,OAAOW,KAAA,OAAAC,MAAA,KAA0BD,KAAA,QAAa5B,EAAAM,GAAAN,EAAA,cAAAO,EAAAC,GAAsC,OAAAL,EAAA,gBAA0BK,MAAAS,OAAea,KAAA,OAAAC,MAAsBC,KAAA,cAAAC,OAA0BC,SAAA3B,EAAA4B,QAAoBhC,EAAA,OAAYiC,aAAaC,KAAA,OAAAC,QAAA,SAAAC,MAAAhC,EAAA,UAAAiC,WAAA,mBAAgFvB,OAASW,KAAA,OAAaA,KAAA,QAAY5B,EAAAe,GAAA,KAAAZ,EAAA,QAAyBc,OAAOW,KAAA,SAAeA,KAAA,UAAc5B,EAAAe,GAAAf,EAAAgB,GAAAT,EAAA8B,SAAArC,EAAAe,GAAA,KAAAZ,EAAA,iBAA8Dc,OAAOW,KAAA,SAAeA,KAAA,UAAczB,EAAA,OAAAA,EAAA,QAAuBE,YAAA,oBAA8BF,EAAA,MAAAH,EAAAe,GAAA,OAAAf,EAAAe,GAAAf,EAAAgB,GAAAT,EAAAkC,eAAA,OAA8D,GAAAzC,EAAAe,GAAA,KAAAZ,EAAA,mBAEz5CuC,oBCCjB,IAcAC,EAdAC,EAAA,OAcAC,CACAzE,EACA0B,GATA,EAVA,SAAAgD,GACAF,EAAA,SAaA,KAEA,MAUAG,EAAA,QAAAJ,EAAA","file":"static/js/30.7d12a8f67acb392cf606.js","sourcesContent":["<template>\r\n    <div class=\"goodslist\">\r\n        <div class=\"itembox\" v-if=\"list.length\">\r\n            <ul>\r\n                <li v-for=\"(item, index) in label\" :key=\"index\">\r\n                    <span :class=\"{active: item.checked}\" @click=\"clickFilter(index)\">{{ item.title }}</span>\r\n                    <div class=\"sort-img\">\r\n                        <img class=\"top\" :src=\"item.top ? icons.topChecked : icons.top\" v-if=\"index\"/>\r\n                        <img class=\"bottom\" :src=\"item.bottom ? icons.bottomChecked : icons.bottom\" />\r\n                    </div>\r\n                </li>\r\n            </ul>\r\n        </div>\r\n        <yd-infinitescroll :callback=\"loadMore\" :distance=\"2\" :scroll-top=\"false\" ref=\"infinitescrollDemo\" class=\"itemgoodslist\">\r\n            <yd-list theme=\"4\" slot=\"list\">\r\n                <yd-list-item v-for='(item, key) in list' :key='key' type=\"link\" :href=\"{path:'goodsdetail',query:{goods_id:item.id}}\">\r\n                    <img slot='img' v-lazy='item.image_url'>\r\n                    <span slot='title'>{{item.name}}</span>\r\n                    <yd-list-other slot='other'>\r\n                        <div>\r\n                            <span class='demo-list-price'><em>¥</em>{{item.price}}</span>\r\n                        </div>\r\n                    </yd-list-other>\r\n                </yd-list-item>\r\n            </yd-list>\r\n        </yd-infinitescroll>\r\n        <yd-backtop></yd-backtop>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n    data () {\r\n        return {\r\n            page: 1,\r\n            pageSize: 10, // 每页10条数据\r\n            label: [\r\n                {title: '综合', checked: true, top: false, bottom: true, condition: ''},\r\n                {title: '销量', checked: false, top: false, bottom: false, condition: 'buy_count'},\r\n                {title: '价格', checked: false, top: false, bottom: false, condition: 'price'}\r\n            ],\r\n            icons: {\r\n                top: './static/image/graytop.png',\r\n                topChecked: './static/image/redtop.png',\r\n                bottom: './static/image/graybottom.png',\r\n                bottomChecked: './static/image/redbottom.png'\r\n            },\r\n            checkedFilter: 0, // 选中的第几个搜索条件 区分再次点击\r\n            filter: this.GLOBAL.getStorage('filter') ? this.GLOBAL.getStorage('filter') : '', // order查询的筛选条件\r\n            catId: this.$route.query.cat_id || 0, // 分类条件\r\n            brand: this.$route.query.brand, // 品牌id\r\n            hot: this.$route.query.hot || 0, // 热门\r\n            keywords: this.$route.query.keywords || 0, // 搜索条件\r\n            list: [] // 指定分类的商品数据\r\n        }\r\n    },\r\n    mounted () {\r\n        if (this.GLOBAL.getStorage('filter')) {\r\n            // 从本地取出筛选状态\r\n            let arr = this.GLOBAL.getStorage('filter').split(' ')\r\n            this.label.forEach((v, k) => {\r\n                if (v.condition === arr[0]) {\r\n                    this.checkedFilter = k // 第几个筛选条件选中\r\n                    v.checked = true\r\n                    arr[1] === 'asc' ? v.top = true : v.top = false\r\n                    arr[1] === 'desc' ? v.bottom = true : v.bottom = false\r\n                } else {\r\n                    v.checked = false\r\n                    v.top = false\r\n                    v.bottom = false\r\n                }\r\n            })\r\n        } else {\r\n            // 否则选中默认的\r\n            this.label[0].checked = true\r\n        }\r\n        this.goodsList()\r\n    },\r\n    methods: {\r\n        // 筛选条件点击\r\n        clickFilter (index) {\r\n            // 如果已经是选中的 再次点击切换倒序升序切换 且不是综合的筛选\r\n            if (this.checkedFilter === index && index !== 0) {\r\n                this.label[index].top = !this.label[index].top\r\n                this.label[index].bottom = !this.label[index].bottom\r\n            } else {\r\n                // 否则切换对应的筛选条件\r\n                this.label.forEach((v, k) => {\r\n                    if (k === index) {\r\n                        this.checkedFilter = index\r\n                        v.checked = true\r\n                        // 此处默认销量降序 价格升序\r\n                        // 销量 k = 1 价格 k = 2\r\n                        if (k === 2) {\r\n                            v.top = true\r\n                        } else {\r\n                            v.bottom = true\r\n                        }\r\n                    } else {\r\n                        v.checked = false\r\n                        v.top = false\r\n                        v.bottom = false\r\n                    }\r\n                })\r\n            }\r\n            // 拼接搜索条件\r\n            let str = ''\r\n            if (this.label[index].condition) str = this.label[index].top ? ' asc' : ' desc'\r\n            this.filter = this.label[index].condition + str\r\n            this.GLOBAL.setStorage('filter', this.filter)\r\n            this.page = 1 // 筛选条件重新第一页开始\r\n            this.goodsList()\r\n        },\r\n        // 获取商品数据\r\n        goodsList () {\r\n            this.$api.goodsList(this.conditions(), res => {\r\n                const _list = res.data.list\r\n                this.list = [..._list]\r\n                if (_list.length < this.pageSize) {\r\n                    /* 所有数据加载完毕 */\r\n                    this.$refs.infinitescrollDemo.$emit('ydui.infinitescroll.loadedDone')\r\n                }\r\n                this.page++\r\n            })\r\n        },\r\n        // 加载更多\r\n        loadMore () {\r\n            this.$api.goodsList(this.conditions(), res => {\r\n                const _list = res.data.list\r\n                this.list = [...this.list, ..._list]\r\n                if (_list.length < this.pageSize) {\r\n                    /* 所有数据加载完毕 */\r\n                    this.$refs.infinitescrollDemo.$emit('ydui.infinitescroll.loadedDone')\r\n                }\r\n                /* 单次请求数据完毕 */\r\n                this.$refs.infinitescrollDemo.$emit('ydui.infinitescroll.finishLoad')\r\n                this.page++\r\n            })\r\n        },\r\n        // 统一返回筛选条件 查询条件 分页\r\n        conditions () {\r\n            let where = {}\r\n            if (this.catId) {\r\n                where = {cat_id: this.catId}\r\n            } else if (this.hot) {\r\n                where = {hot: this.hot}\r\n            } else if (this.keywords) {\r\n                where = {search_name: this.keywords}\r\n            } else if (this.brand) {\r\n                where = {brand_id: this.brand}\r\n            }\r\n            let data = {\r\n                page: this.page,\r\n                limit: this.pageSize,\r\n                where: JSON.stringify(where)\r\n            }\r\n            if (this.filter) data['order'] = this.filter\r\n            return data\r\n        }\r\n    },\r\n    // 路由离开 如果不是进入商品详情页则清除筛选状态\r\n    beforeRouteLeave (to, from, next) {\r\n        if (to.path !== '/goodsdetail') {\r\n            this.GLOBAL.removeStorage('filter')\r\n        }\r\n        next()\r\n    }\r\n}\r\n</script>\r\n\r\n<style>\r\n    .goodslist  .itemgoodslist{\r\n        margin-top: .8rem;\r\n    }\r\n    .goodslist .itembox{\r\n        overflow: hidden;\r\n        zoom: 1;\r\n        background: #fff;\r\n        border-bottom: solid 1px #f5f5f5;\r\n        position: fixed;\r\n        top: 1rem;\r\n        width: 100%;\r\n        z-index: 99999;\r\n        padding: .1rem 0;\r\n        max-width: 750px;\r\n    }\r\n    .goodslist .itembox ul li{\r\n        width: 33.3%;\r\n        float: left;\r\n        height: .6rem;\r\n        line-height: .6rem;\r\n        position: relative;\r\n    }\r\n    .goodslist .itembox ul li img{\r\n        /*vertical-align: middle;*/\r\n    }\r\n    .goodslist .itembox .sort-img{\r\n        display: inline-block;\r\n        position: absolute;\r\n        top: 50%;\r\n        transform: translateY(-50%);\r\n        margin-left: .05rem;\r\n    }\r\n    .goodslist .itembox .sort-img img{\r\n        display: block;\r\n        width: .2rem;\r\n    }\r\n    .goodslist .itembox .sort-img img:nth-child(2n){\r\n        margin-top: .05rem;\r\n    }\r\n    .active {\r\n        color: #FF3B44;\r\n    }\r\n</style>\r\n\n\n\n// WEBPACK FOOTER //\n// src/pages/goods/GoodsList.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"goodslist\"},[(_vm.list.length)?_c('div',{staticClass:\"itembox\"},[_c('ul',_vm._l((_vm.label),function(item,index){return _c('li',{key:index},[_c('span',{class:{active: item.checked},on:{\"click\":function($event){_vm.clickFilter(index)}}},[_vm._v(_vm._s(item.title))]),_vm._v(\" \"),_c('div',{staticClass:\"sort-img\"},[(index)?_c('img',{staticClass:\"top\",attrs:{\"src\":item.top ? _vm.icons.topChecked : _vm.icons.top}}):_vm._e(),_vm._v(\" \"),_c('img',{staticClass:\"bottom\",attrs:{\"src\":item.bottom ? _vm.icons.bottomChecked : _vm.icons.bottom}})])])}))]):_vm._e(),_vm._v(\" \"),_c('yd-infinitescroll',{ref:\"infinitescrollDemo\",staticClass:\"itemgoodslist\",attrs:{\"callback\":_vm.loadMore,\"distance\":2,\"scroll-top\":false}},[_c('yd-list',{attrs:{\"slot\":\"list\",\"theme\":\"4\"},slot:\"list\"},_vm._l((_vm.list),function(item,key){return _c('yd-list-item',{key:key,attrs:{\"type\":\"link\",\"href\":{path:'goodsdetail',query:{goods_id:item.id}}}},[_c('img',{directives:[{name:\"lazy\",rawName:\"v-lazy\",value:(item.image_url),expression:\"item.image_url\"}],attrs:{\"slot\":\"img\"},slot:\"img\"}),_vm._v(\" \"),_c('span',{attrs:{\"slot\":\"title\"},slot:\"title\"},[_vm._v(_vm._s(item.name))]),_vm._v(\" \"),_c('yd-list-other',{attrs:{\"slot\":\"other\"},slot:\"other\"},[_c('div',[_c('span',{staticClass:\"demo-list-price\"},[_c('em',[_vm._v(\"¥\")]),_vm._v(_vm._s(item.price))])])])],1)}))],1),_vm._v(\" \"),_c('yd-backtop')],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-4dcfdb6c\",\"hasScoped\":false,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/pages/goods/GoodsList.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true,\\\"publicPath\\\":\\\"../../\\\"}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-4dcfdb6c\\\",\\\"scoped\\\":false,\\\"hasInlineConfig\\\":false}!../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./GoodsList.vue\")\n}\nvar normalizeComponent = require(\"!../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./GoodsList.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./GoodsList.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-4dcfdb6c\\\",\\\"hasScoped\\\":false,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../node_modules/vue-loader/lib/selector?type=template&index=0!./GoodsList.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/pages/goods/GoodsList.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}